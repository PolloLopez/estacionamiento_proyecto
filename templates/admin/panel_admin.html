{% extends "base.html" %}
{% block title %}Panel Municipal{% endblock %}

{% block content %}
<section class="panel">
  <h2>Panel Municipal</h2>

  <div class="filters">
    <a href="?rol=" class="btn {% if not rol_seleccionado %}active{% endif %}">Todos</a>
    <a href="?rol=vendedor" class="btn {% if rol_seleccionado == 'vendedor' %}active{% endif %}">Vendedores</a>
    <a href="?rol=inspector" class="btn {% if rol_seleccionado == 'inspector' %}active{% endif %}">Inspectores</a>
    <a href="?rol=conductor" class="btn {% if rol_seleccionado == 'conductor' %}active{% endif %}">Conductores</a>
  </div>

  <h3>Estacionamientos registrados</h3>
  <table class="table">
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Patente</th>
        <th>Subcuadra</th>
        <th>Registrado por</th>
        <th>Rol</th>
      </tr>
    </thead>
    <tbody>
      {% for e in estacionamientos %}
        <tr>
          <td>{{ e.hora_inicio }}</td>
          <td>{{ e.vehiculo.patente }}</td>
          <td>{{ e.subcuadra.calle }} {{ e.subcuadra.altura }}</td>
          <td>{{ e.registrado_por.nombre }}</td>
          <td>
            {% if e.registrado_por.es_admin %}Admin{% endif %}
            {% if e.registrado_por.es_inspector %}Inspector{% endif %}
            {% if e.registrado_por.es_vendedor %}Vendedor{% endif %}
            {% if e.registrado_por.es_conductor %}Conductor{% endif %}
          </td>
        </tr>
      {% empty %}
        <tr><td colspan="5">No hay estacionamientos registrados.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <p>Estacionamientos activos: {{ estacionamientos_activos }}</p>

  <h3>Infracciones recientes</h3>
  <ul>
    {% for inf in infracciones_recientes %}
      <li>{{ inf.fecha }} — {{ inf.vehiculo.patente }} — Inspector: {{ inf.inspector.nombre }}</li>
    {% empty %}
      <li>No hay infracciones recientes.</li>
    {% endfor %}
  </ul>
</section>
{% endblock %}
